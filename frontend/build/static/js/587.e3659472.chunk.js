"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[587],{9209:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(5522),i=n(3952),s=n(8700),r=n(5043),a=n(579);class l extends r.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error(e,t)}render(){return this.state.hasError?(0,a.jsxs)(o.az,{display:"flex",justifyContent:"center",alignItems:"center",background:"black",width:"100%",height:"100%",children:[" ",(0,a.jsxs)(o.az,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[" ",(0,a.jsx)(i.E,{fontSize:"2xl",children:"An error occurred. Please "}),(0,a.jsx)(s.N,{color:"teal.500",href:"/dashboard",children:"Go Back..."})]})]}):this.props.children}}const c=l},554:(e,t,n)=>{n.d(t,{A:()=>i});const o=n(6213).A.create();o.interceptors.response.use((async e=>e),(e=>Promise.reject(e)));const i=o},3747:(e,t,n)=>{n.d(t,{ZU:()=>l,bK:()=>a});var o=n(6213),i=n(5043),s=n(5749),r=n(6818);function a(e){const t=(0,i.useRef)(null),{user:n}=(0,r.a)();return(0,i.useEffect)((()=>{if(t.current)return;const o=(0,s.io)("/",{query:{token:e}});return o.on("connect",(()=>{const e=null===n||void 0===n?void 0:n.email;o.emit("newConnection",{email:e})})),o.on("disconnect",(()=>{})),t.current=o,()=>{o.disconnect(),t.current=null}}),[e,null===n||void 0===n?void 0:n.email]),t.current}async function l(e,t,n,i){if(t)try{const s={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(n.token)}},{data:r}=await o.A.post("/api/paycheck/makepaymentmpesa/".concat(n._id,"?amount=").concat(e),{phoneNumber:t},s);r&&i({title:"You have been prompt to finish your subscription process",status:"info",duration:1e3,position:"bottom"})}catch(s){}}},200:(e,t,n)=>{n.d(t,{A:()=>o});const o=e=>{const t=new Date(e),n=new Date-t,o=Math.floor(n/1e3),i=Math.floor(o/60),s=Math.floor(i/60),r=Math.floor(s/24);if(o<60)return"Just now";if(i<60)return"".concat(i," minute").concat(1===i?"":"s"," ago");if(s<24)return"".concat(s," hour").concat(1===s?"":"s"," ago");if(1===r)return"Yesterday";if(r<7)return"".concat(r," day").concat(1===r?"":"s"," ago");{const e={hour:"numeric",minute:"numeric",month:"long",day:"numeric",year:"numeric"};return t.toLocaleDateString("en-US",e)}}},8024:(e,t,n)=>{n.d(t,{A:()=>P});var o=n(8028),i=n(1221),s=n(5522),r=n(3952),a=n(7426),l=n(8360),c=n(9627),d=n(1377),u=n(1273),h=n(532),p=n(7918),f=n(1847),x=n(5156),g=n(8842),m=n(927),b=n(5851),j=n(4929),v=n(1300),y=n(2257),C=n(1823),w=n(3216),k=n(6818),S=n(5532),A=n(4007),z=n(3984),_=n(3224),E=n(6642),I=n(5043),D=n(6213),R=n(579);const N=()=>{const{isOpen:e,onOpen:t,onClose:n}=(0,i.j)(),[a,l]=(0,I.useState)([]),[c,u]=(0,I.useState)(!1),{user:h}=(0,k.a)(),p=(0,w.Zp)(),f=(0,I.useCallback)((async()=>{if(h)try{const e={headers:{Authorization:"Bearer ".concat(h.token)}},{data:t}=await D.A.get("/api/clubs/github/something/".concat(h._id),e);l(t)}catch(e){console.error("Error fetching club requests:",e)}}),[h]);(0,I.useEffect)((()=>{h&&f()}),[h,f]);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(o.$,{backgroundColor:"white",_hover:{backgroundColor:"transparent"},onClick:t,children:[(0,R.jsx)(d._,{src:"https://res.cloudinary.com/dvc7i8g1a/image/upload/v1709643622/icons8-group-48_asymxw.png",height:5}),a&&a.length>0&&(0,R.jsx)(r.E,{position:"absolute",bottom:"70%",right:"70%",transform:"translate(50%, 0)",bg:"red.500",borderRadius:"50%",width:"2px",height:"2px",p:1.5}),(0,R.jsx)(r.E,{})]}),(0,R.jsxs)(S.aF,{isOpen:e,onClose:n,children:[(0,R.jsx)(m.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px) hue-rotate(90deg)"}),(0,R.jsxs)(A.$,{children:[(0,R.jsx)(j.r,{textAlign:"center",children:"Clubs Requests"}),(0,R.jsx)(z.s,{}),(0,R.jsx)(v.c,{display:"flex",justifyContent:"center",alignItems:"center",flexDir:"column",maxH:"300px",children:a&&a.length>0?a.map(((e,t)=>(0,R.jsxs)(s.az,{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",children:[(0,R.jsxs)(o.$,{justifyContent:"space-between",onClick:()=>p("/showclub/".concat(e._id)),children:[t+1,". Club Name: ",e.name]},e._id),(0,R.jsx)(o.$,{background:"#f05e56",onClick:()=>(async e=>{if(h&&e){u(!0);try{const t={headers:{Authorization:"Bearer ".concat(h.token)}},{data:n}=await D.A.get("/api/clubs/decline/request/".concat(e,"/").concat(h._id),t);l(n),u(!1)}catch(t){u(!1),console.error("Error fetching club requests/decline:",t)}}})(e._id),children:c?(0,R.jsx)(_.y,{size:"small"}):"Decline"})]},t))):(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(r.E,{children:"All club requests have been replied to."})})}),(0,R.jsx)(E.j,{fontSize:"small",textDecor:"underline",children:"These requests were made by club coaches."})]})]})]})};const P=function(){const{user:e,notification:t,setNotification:n}=(0,k.a)(),{isOpen:S,onOpen:A,onClose:z}=(0,i.j)(),_=(0,w.Zp)(),E=(0,a.A)({base:"none",md:"flex"}),I=(0,a.A)({base:"hidden",md:"visible"});return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(s.az,{display:"flex",justifyContent:"space-between",alignItems:"center",bg:"white",w:"100%",p:3,paddingBottom:2,boxShadow:"2xl",zIndex:10,top:0,position:"fixed",children:[(0,R.jsx)(r.E,{textAlign:"center",fontSize:{base:"small",md:"medium"},fontWeight:"bold",userSelect:"none",p:0,m:0,pl:3,children:"Worldsamma"}),(0,R.jsxs)(s.az,{display:"flex",justifyContent:"center",alignItems:"center",children:[(0,R.jsx)(o.$,{backgroundColor:"transparent",display:E,visibility:I,_hover:{backgroundColor:"transparent",color:"green.400"},onClick:()=>{_("/dashboard")},children:"My Programs"}),(0,R.jsx)(o.$,{variant:"ghost",onClick:A,_hover:{backgroundColor:"transparent",color:"green.400"},children:(0,R.jsx)(r.E,{display:{base:"none",md:"flex"},px:4,userSelect:"none",children:"Discover"})}),(0,R.jsx)(N,{})]}),(0,R.jsxs)("div",{children:[(0,R.jsxs)(h.W,{children:[(0,R.jsxs)(p.I,{p:1,position:"relative",children:[(0,R.jsx)(y.X,{fontSize:"2xl",p:0,m:0}),t.length>0&&(0,R.jsx)(l.E,{variant:"subtle",position:"absolute",top:"-3px",right:"-3px",backgroundColor:"red",zIndex:1,borderRadius:"50%",color:"white",children:t.length})]}),(0,R.jsxs)(f.c,{pl:2,children:[!t.length&&"No New Messages",t.map((e=>(0,R.jsx)(x.D,{onClick:()=>{n(t.filter((t=>t!==e)))},children:"New Message from ".concat(e.sender?e.sender.name:"Coach"," ADM: ").concat(e.sender?e.sender.admission:" ")},e._id)))]})]}),(0,R.jsx)(h.W,{children:(0,R.jsx)(p.I,{as:o.$,bg:"white",_hover:{backgroundColor:"transparent"},onClick:A,children:"flex"===E?(0,R.jsx)(C.e,{size:"sm",cursor:"pointer",name:null===e||void 0===e?void 0:e.name,src:null===e||void 0===e?void 0:e.pic}):(0,R.jsx)(c.K,{backgroundColor:"transparent",icon:(0,R.jsx)(d._,{src:"https://res.cloudinary.com/dvc7i8g1a/image/upload/v1706276791/icons8-menu-50_afv1fe.png",height:5})})})})]})]}),(0,R.jsxs)(g._,{placement:"left",onClose:z,isOpen:S,children:[(0,R.jsx)(m.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px) hue-rotate(90deg)"}),(0,R.jsxs)(b.z,{children:[(0,R.jsxs)(j.r,{borderBottomWidth:"1px",display:"flex",justifyContent:"space-between",children:["Dashboard",(0,R.jsx)(u.J,{onClick:z})]}),(0,R.jsxs)(v.c,{display:"flex",flexDir:"column",justifyContent:"space-between",width:"100%",children:[(0,R.jsxs)(s.az,{padding:3,display:"flex",justifyContent:"space-around",flexDir:"column",children:[(0,R.jsxs)(o.$,{display:"flex",justifyContent:"left",alignItems:"center",background:"white",m:1,_hover:{backgroundColor:"transparent",color:"green"},onClick:()=>_("/profile"),children:[(0,R.jsx)(C.e,{size:"sm",cursor:"pointer",name:null===e||void 0===e?void 0:e.name,src:null===e||void 0===e?void 0:e.pic}),(0,R.jsx)(r.E,{p:2,m:1,children:"Profile"})]}),(0,R.jsx)(o.$,{justifyContent:"left",background:"white",_hover:{backgroundColor:"transparent",color:"green"},onClick:()=>{_("/dashboard"),z()},children:"My Programs"}),(0,R.jsx)(o.$,{justifyContent:"start",background:"white",_hover:{backgroundColor:"transparent",color:"green"},onClick:()=>{_("/clubs"),z()},children:"Clubs"}),(0,R.jsx)(o.$,{justifyContent:"left",background:"white",_hover:{backgroundColor:"transparent",color:"green"},isDisabled:!(null!==e&&void 0!==e&&e.provinces),onClick:()=>{_("/province"),z()},children:"Provincial level"}),(0,R.jsx)(o.$,{background:"white",justifyContent:"left",_hover:{backgroundColor:"transparent",color:"green"},onClick:()=>{_("/national"),z()},children:"National level"}),(0,R.jsx)(o.$,{background:"white",justifyContent:"left",_hover:{backgroundColor:"transparent",color:"green"},children:"International Championship"})]}),(0,R.jsx)(o.$,{onClick:()=>{localStorage.removeItem("userInfo"),n([]),_("/")},children:"Log out"})]})]})]})]})}},5587:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ie});var o,i,s,r,a,l=n(5043),c=n(9209),d=n(3748),u=n(5522),h=n(8028),p=n(9627),f=n(8024),x=n(7528),g=n(3952),m=n(3308),b=n(2639),j=n(579);const v=m.Ay.div(o||(o=(0,x.A)(["\n  display: flex;\n  justify-content: center;\n  align-items: flex-end;\n  position: relative;\n  width: 100%;\n  padding: 0;\n  margin: 0;\n"]))),y=m.Ay.div(i||(i=(0,x.A)(["\n  display: flex;\n  width: 30%;\n  height: 50px;\n  border: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  font-weight: bold;\n  padding: 0;\n  margin: 0;\n"]))),C=(0,m.i7)(s||(s=(0,x.A)(["\n  from {\n    width: 1%; /* Adjust the initial width as needed */\n  }\n  to {\n    width: ","%;\n  }\n"])),(e=>{let{level:t}=e;return 10*(t+1.2)})),w=(0,m.i7)(r||(r=(0,x.A)(["\n  0%, 100% {\n    background-color: #ed7d66; /* Slightly less green color */\n  }\n  50% {\n    background-color: #66d171; /* Default green color */\n  }\n"]))),k=m.Ay.div(a||(a=(0,x.A)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 50px;\n  height: 14px;\n  background-color: #66d171;\n  border-radius: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  margin: 0;\n  padding: 0;\n  width: ","%;\n  animation: "," 2s ease-in-out,\n    "," 3s ease-in-out infinite;\n"])),(e=>{let{level:t}=e;return 10*(t+1)}),C,w),S=e=>{let{userBelt:t}=e;const n=["Guest","Beginner","Yellow","Orange","Red","Purple","Green","Blue","Brown","Black"].indexOf(t);return(0,j.jsxs)(v,{children:[["Guest","grey","#baba30","orange","red","purple","green","blue","brown","black"].map(((e,t)=>(0,j.jsx)(y,{children:(0,j.jsx)(g.E,{marginTop:-3,fontWeight:{base:"sm",md:"md"},fontSize:{base:"10px",md:"md"},textAlign:"center",children:t>0?(0,j.jsx)(b.n7_,{style:{color:e,fontSize:"1.5rem"}}):e})},t))),(0,j.jsxs)(k,{level:n,children:[" ",(0,j.jsxs)(g.E,{textAlign:"center",fontSize:"small",p:1,children:[10*(n+1),"%"]})," "]})]})};var A=n(1918),z=n(8700),_=n(7118),E=n(1221),I=n(5532),D=n(927),R=n(4007),N=n(4929),P=n(3984),$=n(1300),B=n(1377),q=n(7921),F=n(9673),M=n(6642),O=n(59),W=n(3747),Y=n(6818),L=n(6213);function U(e){let{course:t}=e;const n=(0,d.d)(),{user:o,setUser:i}=(0,Y.a)(),[s,r]=(0,l.useState)(!1),[a,c]=(0,l.useState)(""),{isOpen:p,onOpen:f,onClose:x}=(0,E.j)(),m=(0,W.bK)(null===o||void 0===o?void 0:o.token);(0,l.useEffect)((()=>{if(m)return m.on("noPayment",(e=>{n({title:e,description:"Subscription unsuccessful",status:"info",duration:5e3,position:"bottom"})})),m.on("userUpdated",(async e=>{i((t=>({...t,belt:e.belt}))),n({title:"Successfully updated",description:"Ranked ".concat(e.belt),status:"info",duration:5e3,position:"bottom"})})),()=>{m.off("userUpdated"),m.off("noPayment")}}),[i,n,m]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(h.$,{borderRadius:20,fontSize:"small",background:"#a432a8",textColor:"white",_hover:{color:"black"},m:1,onClick:()=>{const e=o&&o.certificates.length,i=t.id-1;o&&"Guest"===o.belt&&0===i||e+1===i+1?f():o&&o.belt===t.title?n({title:"Currently on this course",description:"You don't need to enroll in this course.",status:"warning",duration:5e3,isClosable:!0}):n({title:"Course Unavailable",description:"You don't meet the requirements to enroll in this course.",status:"warning",duration:5e3,isClosable:!0})},children:"Enroll"}),(0,j.jsxs)(I.aF,{size:"lg",onClose:()=>{r(!1),x()},isOpen:p,isCentered:!0,children:[(0,j.jsx)(D.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px) hue-rotate(90deg)"}),(0,j.jsxs)(R.$,{display:"flex",flexDirection:"column",justifyContent:"center",width:"100%",children:[(0,j.jsx)(N.r,{fontSize:"40px",fontFamily:"Work sans",children:(0,j.jsxs)(g.E,{textAlign:"center",fontSize:"sm",fontWeight:500,p:2,px:3,color:"green.500",rounded:"full",children:["Elevate Your Craft: ",t.title]})}),(0,j.jsx)(P.s,{}),(0,j.jsxs)($.c,{flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",children:[(0,j.jsx)(O.ag,{options:{clientId:"AZAdYFR_SbadcgOcCLYn9ajkReJTZmOCnEeAvQ3xPYAE5BMYFBHi4vDeILfNwBO-hh-8wfyGC9lNeB1I"},children:(0,j.jsx)(O.JV,{createOrder:(e,t)=>t.order.create({purchase_units:[{amount:{currency_code:"USD",value:12..toFixed(2)}}]}),onApprove:async(e,t)=>(await(async()=>{if(o)try{const e={headers:{Authorization:"Bearer ".concat(o.token)}},{data:t}=await L.A.get("/api/user/update",e);i((e=>({...e,belt:t.belt})))}catch(e){e.response&&400===e.response.status?n({title:"Belt achieved!",description:e.response.data.message,status:"info",duration:5e3,isClosable:!0,position:"bottom"}):(console.error("An error occurred:",e),n({title:"An Error Occurred!",description:"Please try again later.",status:"error",duration:5e3,isClosable:!0,position:"bottom"}))}})(),t.order.capture().then((function(t){n({title:"Success",description:e.subscriptionID,status:"info",duration:3e3,isClosable:!0,position:"bottom"})}))),onCancel:()=>{n({title:"Cancelled",description:"Subscription Unsuccessful",status:"info",isClosable:!0,position:"bottom"})}})}),(0,j.jsxs)(h.$,{fontSize:"small",width:"100%",bg:(0,_.dU)("green.100","green.900"),onClick:()=>{r(!0)},p:0,children:[(0,j.jsx)(B._,{height:5,width:"auto",src:"https://res.cloudinary.com/dvc7i8g1a/image/upload/v1694007922/mpesa_ppfs6p.png",alt:"",loading:"lazy"})," ","Pay via Mpesa"]}),s&&(0,j.jsxs)(u.az,{m:3,children:[(0,j.jsx)(g.E,{textAlign:"center",justifyContent:"center",fontSize:"2xl",children:"Enter Your Mpesa Phone Number"}),(0,j.jsx)(q.p,{fontSize:"small",color:"green.400",fontWeight:"bold",placeholder:"i.e 0710334455",textAlign:"center",type:"text",onChange:e=>c(e.target.value),value:a,minLength:10,maxLength:10}),(0,j.jsx)(F.c,{p:2}),(0,j.jsx)(h.$,{width:"100%",onClick:()=>{(0,W.ZU)("4500",a,o,n),r(!1),n({title:"Wait as message is sent",status:"loading",isClosable:!0,position:"bottom",duration:5e3})},isDisabled:a.length!==parseInt(10),colorScheme:"green",children:"Proceed"}),(0,j.jsx)(g.E,{textAlign:"center",justifyContent:"center",children:"You'll be sent a Message"})]})]}),(0,j.jsx)(M.j,{display:"flex"})]})]})]})}const G=e=>{let{courses:t,user:n}=e;const o=(e,t)=>{const n=document.createElement("a");n.href=t,n.download="".concat(e,"BeltCertificate.pdf"),n.click()},i=["#baba30","orange","red","purple","green","blue","brown","black"];return(0,j.jsxs)(u.az,{display:"flex",flexDir:"column",alignItems:"center",justifyContent:"center",width:"100%",p:4,backgroundColor:"white",children:[(0,j.jsx)(g.E,{fontSize:"20px",fontWeight:"medium",children:"My Programs"}),t.map(((e,t)=>(0,j.jsxs)(A.s,{display:"flex",alignItems:"center",justifyContent:"space-between",m:4,p:{base:"1",md:"4"},width:{base:"90%",md:"70%"},border:"1px",borderRadius:5,children:[(0,j.jsxs)(u.az,{children:[(0,j.jsxs)(g.E,{fontSize:"larger",fontWeight:"medium",children:[(0,j.jsx)(g.E,{children:e.title}),(0,j.jsx)(b.n7_,{style:{color:i[t],fontSize:"3rem"}})]}),e.title===(null===n||void 0===n?void 0:n.belt)&&(0,j.jsx)(z.N,{href:"/courses/".concat(e.id),style:{textDecoration:"none",color:"inherit"},p:0,m:0,children:"Continue"})]}),n&&n.certificates&&n.certificates[t]?(0,j.jsx)(h.$,{onClick:o(e.title,n.certificates[t]),borderRadius:20,fontSize:"small",children:"Download Certificate"}):(0,j.jsxs)(u.az,{display:"flex",flexDir:"column",justifyContent:"space-between",alignItems:"center",children:[(0,j.jsx)(U,{course:e}),(0,j.jsx)(g.E,{fontSize:"sm",fontWeight:400,bg:(0,_.dU)("green.50","green.900"),p:3,px:3,color:"green.500",rounded:"full",children:"$12 Only"})]})]},e.id)))]})};var Z=n(3224),K=n(2696),T=n(834),J=n(200);const X=function(e){var t,n,o,i,s;let{m:r}=e;const{user:a,setSelectedChat:l,setSend:c}=(0,Y.a)();return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(u.az,{display:"flex",flexDir:"column",position:"relative",fontSize:"small",onClick:()=>{var e,t,n;(null===(e=r.sender)||void 0===e?void 0:e._id)!==a._id&&(l(null===(t=r.sender)||void 0===t?void 0:t._id),c(null===(n=r.sender)||void 0===n?void 0:n.name))},children:[(0,j.jsx)(g.E,{fontSize:"smaller",textDecor:"underline",textAlign:"end",children:(null===(t=r.sender)||void 0===t?void 0:t._id)===a._id?"You to ".concat(null===(n=r.recipient)||void 0===n?void 0:n.name):(0,j.jsxs)(g.E,{children:[null===(o=r.sender)||void 0===o?void 0:o.name," -",null===(i=r.sender)||void 0===i?void 0:i.admission]})}),r.content,(0,j.jsxs)(g.E,{display:"flex",textAlign:"right",m:0,p:0,fontSize:"2xs",children:[(null===(s=r.sender)||void 0===s?void 0:s._id)===a._id?(0,j.jsx)(B._,{src:"https://res.cloudinary.com/dvc7i8g1a/image/upload/v1699355257/icons8-sent-64_e9vrai.png",height:5,p:0,loading:"lazy",m:0}):"",(0,J.A)(r.createdAt)]})]})})},H=e=>{let{messages:t}=e;const{user:n}=(0,Y.a)();return(0,j.jsx)(K.A,{height:"100%",children:(0,j.jsx)(T.T,{align:"start",spacing:4,p:4,maxH:"95%",overflowY:"auto",children:t.map(((e,t)=>{var o;if(!e&&!n)return null;const i=(null===(o=e.sender)||void 0===o?void 0:o._id)===n._id;return(0,j.jsx)(u.az,{bg:i?"#BEE3F8":"#B9F5D0",borderRadius:"20px",p:"5px 15px",maxW:"75%",alignSelf:i?"flex-end":"flex-start",children:(0,j.jsx)(X,{m:e})},e._id)}))})})};var Q=n(3216),V=n(423);const ee=e=>{let{onClose:t}=e;const n=(0,d.d)(),[o,i]=(0,l.useState)(""),[s,r]=(0,l.useState)(["WSF","Coach","Provincial Coach","National Coach"]),[a,c]=(0,l.useState)(null),[f,x]=(0,l.useState)(null),[m,b]=(0,l.useState)(),[v,y]=(0,l.useState)(!1),[C,w]=(0,l.useState)(!1),{user:k,selectedChat:S,setSelectedChat:A,send:z,setSend:_,messages:E,setMessages:I,national:D,province:R}=(0,Y.a)(),N=(0,Q.Zp)(),P=(0,W.bK)(null===k||void 0===k?void 0:k.token);(0,l.useEffect)((()=>{(null!==k&&void 0!==k&&k.admin||null!==k&&void 0!==k&&k.coach||(null===R||void 0===R?void 0:R.provincialCoach._id)===(null===k||void 0===k?void 0:k._id)||(null===D||void 0===D?void 0:D.nationalCoach._id)===(null===k||void 0===k?void 0:k._id))&&y(!0)}),[k,D,R,y]),(0,l.useEffect)((()=>{void 0===k.provinces&&r((e=>e.filter((e=>"Provincial Coach"!==e))))}),[k.provinces]),(0,l.useEffect)((()=>"Coach"!==a||null!==k&&void 0!==k&&k.physicalCoach?"Provincial Coach"!==a||R?"National Coach"!==a||D?void 0:(c(null),N("/national"),void n({title:"National Samma Association seat is empty!",description:"Apply for Interim",status:"info",duration:5e3,position:"bottom-left"})):(c(null),N("/province"),void n({title:"Provincial Samma Association seat is empty!",description:"Apply for Interim",status:"info",duration:5e3,position:"bottom-left"})):(N("/clubs"),n({title:"You've not joined a Club",description:"Join a club or make one as you'd please",status:"info",duration:5e3,position:"bottom-left"}),void c(null))),[a,N,k,D,R,n]);const $=(0,l.useCallback)((async()=>{if(k)try{const e={headers:{Authorization:"Bearer ".concat(k.token)}};b(!0);const{data:t}=await L.A.get("/api/message/".concat(k._id),e);I(t),b(!1)}catch(e){console.log(e),b(!1),n({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}}),[n,k]);(0,l.useEffect)((()=>{$()}),[$]),(0,l.useEffect)((()=>{"Coach"===a?x(k.physicalCoach):"WSF"===a&&k?x(k.wsf):"Provincial Coach"===a&&R?x(R.provincialCoach._id):"National Coach"===a&&D&&x(D.nationalCoach._id)}),[a,D,R,k,x]),(0,l.useEffect)((()=>{S&&x(S)}),[S,x]);return(0,j.jsxs)(u.az,{display:"flex",flexDirection:"column",position:"fixed",bottom:"0",right:"1",height:"90vh",width:{base:"95%",lg:"450px"},background:"white",borderRadius:4,boxShadow:"dark-lg",p:"6",rounded:"md",bg:"white",zIndex:11,children:[(0,j.jsx)(h.$,{p:2,onClick:()=>{t()},children:"X"}),(0,j.jsxs)(u.az,{p:2,top:"0",left:"0",height:"95%",display:"flex",flexDir:"column",justifyContent:"center",children:[!a&&!v&&(0,j.jsxs)(u.az,{display:"flex",flexDir:"column",bg:"transparent",children:[(0,j.jsx)(g.E,{children:"Select whom you want to chat with:"}),s.map((e=>(0,j.jsx)(h.$,{bg:"transparent",onClick:()=>c(e),children:e},e)))]}),m?(0,j.jsx)(Z.y,{size:"lg"}):(0,j.jsx)(H,{messages:E}),(0,j.jsxs)(u.az,{position:"absolute",bottom:0,width:"100%",children:[v&&(0,j.jsxs)(u.az,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",children:["Replying to ",S?z:"(select a message please)",S&&(0,j.jsx)(h.$,{onClick:()=>{A(null),_(null)},background:"transparent",textColor:"red",children:"X"})]}),a&&(0,j.jsxs)(u.az,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",children:["Chatting with ",a,(0,j.jsx)(h.$,{onClick:()=>c(null),background:"transparent",textColor:"red",children:"X"})]}),(0,j.jsxs)(u.az,{display:"flex",justifyContent:"center",alignItems:"center",width:"90%",background:"white",children:[(0,j.jsx)(q.p,{placeholder:"Type your message...",value:o,onChange:e=>i(e.target.value)}),(0,j.jsx)(p.K,{isLoading:C,onClick:e=>(async e=>{if(e&&"click"===e.type||e&&"Enter"===e.key){if(w(!0),!a&&!v)return console.log("Select a recipient: Please choose whom you want to chat with."),n({title:"Select a recipient",description:"Please choose whom you want to chat with.",status:"info",duration:5e3,isClosable:!0,position:"bottom"}),void w(!1);if(v&&!S)return console.log("Select a recipient: Please choose whom you want to reply to."),n({title:"Select a recipient",description:"Please choose whom you want to reply to.",status:"info",duration:5e3,isClosable:!0,position:"bottom"}),void w(!1);try{const e=k._id,t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(k.token)}};i("");const{data:n}=await L.A.post("/api/message",{sender:f,content:o,userId:e},t);I((e=>[...e,n])),P.emit("new message",n),w(!1)}catch(t){w(!1),console.log(t),n({title:"Failed to send the Message",description:"Please try again after some time",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}}})(e),p:0,m:1,children:(0,j.jsx)(V.sfP,{})})]})]})]})]})};var te=n(554);const ne=()=>((0,l.useEffect)((()=>{(window.adsbygoogle=window.adsbygoogle||[]).push({})}),[]),(0,j.jsxs)(u.az,{display:"flex",alignItems:"center",justifyContent:"space-between",flexDir:"column",width:{base:"100%",md:"70%"},borderRadius:5,position:"relative",children:[(0,j.jsx)(g.E,{textAlign:"center",fontSize:"large",children:"Advertisement"}),(0,j.jsx)("ins",{className:"adsbygoogle",style:{display:"block",width:"100%"},"data-ad-client":"ca-pub-9398367168853498","data-ad-slot":"2234347600","data-ad-format":"auto","data-full-width-responsive":"true"})]}));var oe=n(6720);const ie=e=>{let{courses:t}=e;const[n,o]=(0,l.useState)(!1),{user:i,setUser:s,setClub:r,setMessages:a,notification:x,setNotification:g,setNational:m,setProvince:b}=(0,Y.a)(),v=(0,Q.Zp)(),[y,C]=(0,l.useState)(!1),[w,k]=(0,l.useState)(!1),A=(0,d.d)(),[z,_]=(0,l.useState)([]),E=(0,W.bK)(null===i||void 0===i?void 0:i.token);(0,l.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("userInfo"));e?s(e):v("/")}),[s,v]);const I=(0,l.useCallback)((async()=>{if(null!==i&&void 0!==i&&i.coach)try{const e=i.coach,t={headers:{Authorization:"Bearer ".concat(i.token)}};te.A.get("/api/clubs/".concat(e),t).then((async e=>{r(e.data)})).catch((e=>{}))}catch(e){console.error("Error fetching Club:",e)}}),[null===i||void 0===i?void 0:i.token,r]);(0,l.useEffect)((()=>{if(!E)return;return E.on("message received",(e=>{g([e,...x]),((e,t)=>{if("granted"===Notification.permission){new Notification(e,t);const n=new Audio("https://s3.amazonaws.com/freecodecamp/drums/Give_us_a_light.mp3");n.addEventListener("error",(e=>{console.error("Audio playback error:",e)})),n.play().catch((e=>{console.error("Audio playback error:",e)}))}else"denied"!==Notification.permission&&Notification.requestPermission().then((n=>{if("granted"===n){new Notification(e,t);const n=new Audio("https://s3.amazonaws.com/freecodecamp/drums/Give_us_a_light.mp3");n.addEventListener("error",(e=>{console.error("Audio playback error:",e)})),n.play().catch((e=>{console.error("Audio playback error:",e)}))}}))})("New Message",{body:"New message from ".concat(e.sender.name),icon:"".concat(e.sender.pic)}),a((t=>[...t,e]))})),E.on("updates",(e=>{s((t=>({...t,belt:e.belt,clubRequests:e.clubRequests,provinceRequests:e.provinceRequests,nationalRequests:e.nationalRequests})))})),E.on("provincial request",(e=>{s((t=>({...t,provinceRequests:[...t.provinceRequests,e.provincialCoach]})))})),E.on("national request",(e=>{s((t=>({...t,provinceRequests:[...t.nationalRequests,e.nationalCoach]})))})),E.on("liveSessionStarted",(e=>{_((t=>({...t,clubName:e})))})),E.on("certificates",(e=>{s((t=>({...t,certificates:e.certificates,belt:e.belt})))})),()=>{E.off("updates"),E.off("provincial request"),E.off("liveSessionStarted"),E.off("message received"),E.off("certificates")}}),[E,s,null===i||void 0===i?void 0:i.token,i]);const D=(0,l.useCallback)((async()=>{if(!i)return void v("/dashboard");const e={headers:{Authorization:"Bearer ".concat(i.token)}};try{te.A.get("/api/province/officials/".concat(i.country,"/").concat(i.provinces),e).then((async e=>{0===e.data.length||b(data)})).catch((e=>{e.response&&401===e.response.status&&(A({title:"Your session has expired",description:"Logging out in 8 seconds",duration:8e3,status:"loading",position:"bottom"}),setTimeout((()=>{localStorage.removeItem("userInfo"),v("/")}),8e3))}))}catch(t){console.log(t)}try{const{data:t}=await L.A.get("/api/national/officials/".concat(i.country,"/").concat(i.provinces),e);0===t.length||m(t)}catch(t){console.log(t),A({title:"An Error Occurred!",description:"Try again after sometime.",status:"error",duration:5e3,isClosable:!0})}}),[i,m,A,b]);return(0,l.useEffect)((()=>{i?(D(),I()):v("/dashboard")}),[D,v,i]),(0,j.jsx)(c.A,{fallback:(0,j.jsx)("p",{style:{color:"white"},children:"Something went wrong"}),userSelect:"none",children:(0,j.jsxs)(u.az,{display:"flex",alignItems:"center",justifyContent:"center",flexDir:"column",width:"100%",background:"white",position:"relative",children:[(0,j.jsx)(f.A,{}),(0,j.jsx)(u.az,{width:"100%",mt:20,children:(0,j.jsx)(S,{userBelt:null===i||void 0===i?void 0:i.belt})}),(0,j.jsx)(G,{courses:t,user:i}),n&&(0,j.jsx)(ee,{onClose:()=>o(!1)}),z.length>0&&(0,j.jsxs)(u.az,{position:"fixed",top:"90px",right:"50px",borderRadius:"20px",border:"1px solid #d24ce0",children:[!w&&(0,j.jsxs)(h.$,{backgroundColor:"white",_hover:{backgroundColor:"white"},onClick:()=>k(!0),width:"100%",border:"1px solid #d24ce0",borderRadius:"20px",children:["Live Clubs","\xa0",(0,j.jsx)(oe.oHc,{style:{fontSize:"30px"}})]}),w&&z.map((e=>(0,j.jsx)(h.$,{textAlign:"center",width:"100%",backgroundColor:"white",_hover:{backgroundColor:"white"},onClick:()=>{_((t=>t.filter((t=>t!==e)))),v("/showclub/".concat(e._id,"/",!0)),k(!1)},borderRadius:"20px",children:"".concat(e.name," are live...")},e._id)))]}),(0,j.jsx)(p.K,{display:n?"none":"flex",position:"fixed",bottom:"10px",right:"10px",icon:(0,j.jsx)(oe.X5G,{style:{width:y?"60px":"40px",transition:"width 0.3s ease-in-out",color:"teal",fontSize:"30px"}}),backgroundColor:"white",border:"1px solid black",_hover:{backgroundColor:"white"},onClick:()=>o(!0),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),borderRadius:"20px"}),(0,j.jsx)(ne,{})]})})}}}]);
//# sourceMappingURL=587.e3659472.chunk.js.map